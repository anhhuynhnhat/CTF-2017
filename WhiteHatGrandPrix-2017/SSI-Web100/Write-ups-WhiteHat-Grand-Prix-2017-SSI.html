<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>[Write-ups]WhiteHat Grand Prix 2017 — SSI</title><meta name="description" content="Đây là bài web 100 điểm. Lêu lâu về miền Nam mà bạn bè ai cũng đi làm cả tuần, chỉ có rảnh ngày nghỉ mà lại đúng lúc có giải này, nên lúc…"><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">[Write-ups]WhiteHat Grand Prix 2017 — SSI</h1>
</header>
<section data-field="subtitle" class="p-summary">
Đây là bài web 100 điểm. Lêu lâu về miền Nam mà bạn bè ai cũng đi làm cả tuần, chỉ có rảnh ngày nghỉ mà lại đúng lúc có giải này, nên lúc…
</section>
<section data-field="body" class="e-content">
<section name="71bf" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="f5c1" id="f5c1" class="graf graf--h3 graf--leading graf--title">[Write-ups]WhiteHat Grand Prix 2017 — SSI</h3><p name="34c3" id="34c3" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--h3"><span class="graf-dropCap">Đ</span>ây là bài web 100 điểm. Lêu lâu về miền Nam mà bạn bè ai cũng đi làm cả tuần, chỉ có rảnh ngày nghỉ mà lại đúng lúc có giải này, nên lúc viết write-up này mình viết hơi sơ sài để ngủ =)), có thời gian sẽ thêm thắt câu chữ lại cho các bạn.</p><blockquote name="b4ea" id="b4ea" class="graf graf--blockquote graf-after--p">Link: <a href="http://ssi.grandprix.whitehatvn.com/" data-href="http://ssi.grandprix.whitehatvn.com/" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">http://ssi.grandprix.whitehatvn.com/</a> (main) <a href="http://bak.ssi.grandprix.whitehatvn.com/" data-href="http://bak.ssi.grandprix.whitehatvn.com/" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">http://bak.ssi.grandprix.whitehatvn.com/</a> (backup)</blockquote></div><div class="section-inner sectionLayout--fullWidth"><figure name="a8fd" id="a8fd" class="graf graf--figure graf--layoutFillWidth graf-after--blockquote"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45.4%;"></div><img class="graf-image" data-image-id="1*OLAL2ayu4BEy3_3EzPz0-Q.png" data-width="1717" data-height="780" src="https://cdn-images-1.medium.com/max/2000/1*OLAL2ayu4BEy3_3EzPz0-Q.png"></div><figcaption class="imageCaption">Giao diện ban đầu</figcaption></figure></div><div class="section-inner sectionLayout--outsetColumn"><figure name="55a1" id="55a1" class="graf graf--figure graf--layoutOutsetCenter graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 408px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40.8%;"></div><img class="graf-image" data-image-id="1*PnVCm6KdvYQBdYsCpEVVkg.png" data-width="1098" data-height="448" src="https://cdn-images-1.medium.com/max/1000/1*PnVCm6KdvYQBdYsCpEVVkg.png"></div><figcaption class="imageCaption">Xài thử coi sao — đổi màu theo ý</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><figure name="6753" id="6753" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 184px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 26.3%;"></div><img class="graf-image" data-image-id="1*RFUDHr0kTpEskHXDETSwwQ.png" data-width="756" data-height="199" src="https://cdn-images-1.medium.com/max/800/1*RFUDHr0kTpEskHXDETSwwQ.png"></div><figcaption class="imageCaption">Kiểm tra với Burpsuite</figcaption></figure><p name="c716" id="c716" class="graf graf--p graf-after--figure">Xem source không thấy gì lạ, kiểm tra file backup (index.php~) thì lấy được đoạn sau:</p></div><div class="section-inner sectionLayout--fullWidth"><figure name="3ffa" id="3ffa" class="graf graf--figure graf--layoutFillWidth graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 35.099999999999994%;"></div><img class="graf-image" data-image-id="1*tAnYQ2ya6PS0t3FT37zeJQ.png" data-width="1117" data-height="392" src="https://cdn-images-1.medium.com/max/2000/1*tAnYQ2ya6PS0t3FT37zeJQ.png"></div><figcaption class="imageCaption">Source backup</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="9b04" id="9b04" class="graf graf--p graf-after--figure">Nghĩa là tham số truyền vào sẽ có thêm secret thay vì chỉ có textColor như ban đầu mình kiểm tra bằng Burpsuite. Nhưng chúng ta cần quan tâm là dòng 16, để nhảy vào case này thì phải làm sao cho chuỗi SHA-1 của “secret” và “textColor” (nối với nhau) lại có 3 ký tự cuối cùng là “ab1”.</p></div><div class="section-inner sectionLayout--fullWidth"><figure name="4cb7" id="4cb7" class="graf graf--figure graf--layoutFillWidth graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.3%;"></div><img class="graf-image" data-image-id="1*r7mpXvNxr34gD23AOMdJ7g.png" data-width="1759" data-height="868" src="https://cdn-images-1.medium.com/max/2000/1*r7mpXvNxr34gD23AOMdJ7g.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="f46f" id="f46f" class="graf graf--p graf-after--figure">Code Java dài ngoằn, các bạn nên dùng Python cho nhanh nhé.</p><figure name="19c6" id="19c6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/anhhuynhnhat/657bc5eb32c40e80f990fb0c67bd366b.js.js"></script></figure><p name="366a" id="366a" class="graf graf--p graf-after--figure">Vậy là ra được mấy số, lấy cái đầu tiên xài thì sẽ ra URL như sau:</p><blockquote name="db6e" id="db6e" class="graf graf--blockquote graf-after--p"><a href="http://ssi.grandprix.whitehatvn.com/index.php?secret=18&amp;textColor=28&amp;submit=Change" data-href="http://ssi.grandprix.whitehatvn.com/index.php?secret=18&amp;textColor=28&amp;submit=Change" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank"><em class="markup--em markup--blockquote-em">http://ssi.grandprix.whitehatvn.com/index.php?secret=18&amp;textColor=28&amp;submit=Change</em></a></blockquote><p name="6c9a" id="6c9a" class="graf graf--p graf-after--blockquote">Chỗ này các bạn có thể sửa trực tiếp trong request như sau:</p><pre name="9cfd" id="9cfd" class="graf graf--pre graf-after--p">POST /index.php HTTP/1.1<br>Host: ssi.grandprix.whitehatvn.com<br>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:58.0) Gecko/20100101 Firefox/58.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br>Accept-Language: en-US,en;q=0.5<br>Accept-Encoding: gzip, deflate<br>Referer: <a href="http://ssi.grandprix.whitehatvn.com/index.php?secret=23&amp;textColor=78&amp;submit=Change" data-href="http://ssi.grandprix.whitehatvn.com/index.php?secret=23&amp;textColor=78&amp;submit=Change" class="markup--anchor markup--pre-anchor" rel="nofollow noopener" target="_blank">http://ssi.grandprix.whitehatvn.com/index.php?secret=23&amp;textColor=78&amp;submit=Change</a><br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 22<br>Cookie: PHPSESSID=ovbq9nm15sasgbn05gtdkn5b40; WH-grandprix=SSBsb3ZlIHdoaXRlaGF0<br>Connection: close<br>Upgrade-Insecure-Requests: 1</pre><pre name="00ae" id="00ae" class="graf graf--pre graf-after--pre">secret=23&amp;textColor=78</pre><p name="ba9e" id="ba9e" class="graf graf--p graf-after--pre">Cũng không hiểu vì sao Firefox thì chuyển hướng được còn Chrome thì nằm im luôn. Các bạn được đưa sang showip.php, và sau khi chuyển hướng thì cookie nó ghi lại rồi nên mình không thể quay lại index.php nữa.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="efa3" id="efa3" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 454px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45.4%;"></div><img class="graf-image" data-image-id="1*AmQT42HyppWHMD-PX0BhUQ.png" data-width="1717" data-height="780" src="https://cdn-images-1.medium.com/max/1000/1*AmQT42HyppWHMD-PX0BhUQ.png"></div><figcaption class="imageCaption">showip.php — để mình tự xem IP của mình</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="5b35" id="5b35" class="graf graf--p graf-after--figure">Chuyển đến result.shtml để hiện kết quả</p><figure name="6077" id="6077" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 555px; max-height: 421px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75.9%;"></div><img class="graf-image" data-image-id="1*PtQ9FJqo7wE_QOAOZbnRpg.png" data-width="555" data-height="421" src="https://cdn-images-1.medium.com/max/800/1*PtQ9FJqo7wE_QOAOZbnRpg.png"></div><figcaption class="imageCaption">Chuyển đến result.shtml để hiện IP kèm tên do mình tự tay nhập.</figcaption></figure><p name="ee1a" id="ee1a" class="graf graf--p graf-after--figure">Mã nguồn của showip.php</p><figure name="30b3" id="30b3" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/anhhuynhnhat/818f54344663178966ec3005c8efb7fa.js.js"></script></figure><p name="334c" id="334c" class="graf graf--p graf-after--figure">Dòng trên cùng đề có cho console log, viết tường minh ra thì nó như sau:</p><pre name="0c6c" id="0c6c" class="graf graf--pre graf-after--p">Debug Objects: Flag at directory: value_special/flag.txt’ );<br>&lt;/script&gt;<br>&lt;script&gt;<br> console.log( ‘Debug Objects: value_special = md5(filesize(index.php)-namechannelIRC)’ );<br>&lt;/script&gt;<br>&lt;script&gt;<br> console.log( ‘Debug Objects: — is a character’ );</pre><p name="54b3" id="54b3" class="graf graf--p graf-after--pre">Nghĩa là chúng ta sẽ phải tìm cái “value_special”, mà đề cho thêm thông tin về “value_special” là:</p><blockquote name="ba1f" id="ba1f" class="graf graf--blockquote graf-after--p">value_special = md5(filesize(index.php)-namechannelIRC) <br>“-” is a character</blockquote><blockquote name="af54" id="af54" class="graf graf--blockquote graf-after--blockquote"><em class="markup--em markup--blockquote-em">=&gt;&gt; IRC channel: #whitehatgrandprix2017 và dấu “-” không phải là dấu trừ</em></blockquote><p name="229f" id="229f" class="graf graf--p graf-after--blockquote">Còn lại là chuyển công thức trên kia:</p><blockquote name="648e" id="648e" class="graf graf--blockquote graf-after--p">MD5 hash:</blockquote><blockquote name="1f58" id="1f58" class="graf graf--blockquote graf-after--blockquote">1.6K-<em class="markup--em markup--blockquote-em">#whitehatgrandprix2017 =&gt; </em>36789f5cc2688fb98476eea77c6696fe</blockquote><blockquote name="22bd" id="22bd" class="graf graf--blockquote graf-after--blockquote">Link flag: <a href="http://ssi.grandprix.whitehatvn.com/36789f5cc2688fb98476eea77c6696fe/flag.txt" data-href="http://ssi.grandprix.whitehatvn.com/36789f5cc2688fb98476eea77c6696fe/flag.txt" class="markup--anchor markup--blockquote-anchor" rel="nofollow noopener" target="_blank">http://ssi.grandprix.whitehatvn.com/36789f5cc2688fb98476eea77c6696fe/flag.txt</a></blockquote><pre name="2b26" id="2b26" class="graf graf--pre graf-after--blockquote">Learn_form_yesterday.Live_for_today.Hope_for_tomorrow.</pre><p name="9700" id="9700" class="graf graf--p graf-after--pre">Băm chuỗi trên ra và bỏ vào cho đúng flag format:</p><h4 name="d3c2" id="d3c2" class="graf graf--h4 graf-after--p graf--trailing">Flag: WhiteHat{dffb112c136d8317033a2152b8d32a3125cd4e4c}</h4></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@K0T3Z4" class="p-author h-card">HERR KOTEZA</a> on <a href="https://medium.com/p/23fef244aedc"><time class="dt-published" datetime="2017-12-17T16:32:49.417Z">December 17, 2017</time></a>.</p><p><a href="https://medium.com/@K0T3Z4/write-ups-whitehat-grand-prix-2017-ssi-23fef244aedc" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 19, 2017.</p></footer></article>

</body></html>